/*
 * spectra.cpp
 *
 *  Created on: 2011-02-23
 *      Author: weaver
 */

#include "MultiAngleFLIC.h"
using namespace std;
/*
int Spectra::defineInterpolators (string dye, double* lambda, double* em, int& elements) {

	double* lambda;
	double* em;
	int elements;
	gsl_interp_accel *acc;
	gsl_spline *spline;

	if (dye == "DiO" || dye == "DIO" || dye == "dio") {
		elements = 175;

		double DiO_Lam [] = {475.0,476.0,477.0,478.0,479.0,480.0,481.0,482.0,483.0,484.0,485.0,486.0,487.0,488.0,489.0,
				490.0,491.0,492.0,493.0,494.0,495.0,496.0,497.0,498.0,499.0,500.0,501.0,502.0,503.0,504.0,505.0,506.0,
				507.0,508.0,509.0,510.0,511.0,512.0,513.0,514.0,515.0,516.0,517.0,518.0,519.0,520.0,521.0,522.0,523.0,
				524.0,525.0,526.0,527.0,528.0,529.0,530.0,531.0,532.0,533.0,534.0,535.0,536.0,537.0,538.0,539.0,540.0,
				541.0,542.0,543.0,544.0,545.0,546.0,547.0,548.0,549.0,550.0,551.0,552.0,553.0,554.0,555.0,556.0,557.0,
				558.0,559.0,560.0,561.0,562.0,563.0,564.0,565.0,566.0,567.0,568.0,569.0,570.0,571.0,572.0,573.0,574.0,
				575.0,576.0,577.0,578.0,579.0,580.0,581.0,582.0,583.0,584.0,585.0,586.0,587.0,588.0,589.0,590.0,591.0,
				592.0,593.0,594.0,595.0,596.0,597.0,598.0,599.0,600.0,601.0,602.0,603.0,604.0,605.0,606.0,607.0,608.0,
				609.0,610.0,611.0,612.0,613.0,614.0,615.0,616.0,617.0,618.0,619.0,620.0,621.0,622.0,623.0,624.0,625.0,
				626.0,627.0,628.0,629.0,630.0,631.0,632.0,633.0,634.0,635.0,636.0,637.0,638.0,639.0,640.0,641.0,642.0,
				643.0,644.0,645.0,646.0,647.0,648.0,649.0};

		double DiO_Em [] = {3.0,3.3,3.6,3.9,4.227634,4.334085,4.851135,5.596293,6.610907,7.863134,9.405489,11.28668,
				13.40097,15.98194,19.05524,22.77534,27.03101,31.90448,37.41,43.53095,49.96317,56.63301,63.31234,69.79446,
				75.69918,81.00748,86.12807,90.85423,94.7511,97.44565,99.2824,100,99.68635,98.55293,96.68528,94.12617,
				90.6974,87.44446,84.21765,80.97185,77.59059,74.24023,71.12748,68.00285,64.98753,62.23357,59.8503,57.75217,
				56.1554,54.78437,53.83153,52.85732,51.91874,51.17025,50.49543,49.99406,49.2432,48.51135,47.77474,47.14744,
				46.57954,45.94749,45.41285,44.7713,44.14875,43.3171,42.4902,41.54687,40.69621,39.55566,38.5458,37.30545,
				36.26233,35.10277,34.16419,33.09731,32.10408,30.88274,29.78258,28.72995,27.77474,26.8623,25.93561,25.18712,
				24.45527,23.69752,22.84876,22.14376,21.41975,20.88559,20.2407,19.75288,19.13865,18.5496,17.92634,17.40596,
				16.83474,16.35286,15.8351,15.43804,15.05738,14.70595,14.37401,14.01758,13.6393,13.2931,12.98277,12.64013,
				12.30557,11.99002,11.76809,11.48224,11.1769,10.8661,10.63918,10.40109,10.13591,9.806819,9.541405,9.298563,
				9.076156,8.735892,8.468575,8.179874,7.955328,7.688012,7.484852,7.260307,7.031009,6.801236,6.58168,6.355471,
				6.096947,5.870738,5.644529,5.474397,5.29286,5.13247,4.915528,4.720209,4.546513,4.415112,4.272069,4.150648,
				3.983367,3.860283,3.712249,3.598432,3.48105,3.343472,3.235119,3.102768,3.026494,2.960675,2.928359,2.844244,
				2.75894,2.654865,2.572651,2.513485,2.41131,2.355637,2.263206,2.265962,2.195248,2.147963,2.063205,2.018296,
				1.934656,1.875252,1.810621,1.799857,1.775858,1.777284,1.774979};

		for (i = 0; i < elements; i++) {
			lambda[i] = DiO_lam[i];
			em[i] = DiO_lam[i];
		}
		lambda = DiO_Lam;
		em = DiO_Em;

	}

	else if (dye == "DiI" || dye == "DII" || dye == "dii") {

		elements = 170;

		double DiI_Lam [] = {530.0,531.0,532.0,533.0,534.0,535.0,536.0,537.0,538.0,539.0,540.0,541.0,542.0,543.0,544.0,545.0,
			546.0,547.0,548.0,549.0,550.0,551.0,552.0,553.0,554.0,555.0,556.0,557.0,558.0,559.0,560.0,561.0,562.0,563.0,
			564.0,565.0,566.0,567.0,568.0,569.0,570.0,571.0,572.0,573.0,574.0,575.0,576.0,577.0,578.0,579.0,580.0,581.0,
			582.0,583.0,584.0,585.0,586.0,587.0,588.0,589.0,590.0,591.0,592.0,593.0,594.0,595.0,596.0,597.0,598.0,599.0,
			600.0,601.0,602.0,603.0,604.0,605.0,606.0,607.0,608.0,609.0,610.0,611.0,612.0,613.0,614.0,615.0,616.0,617.0,
			618.0,619.0,620.0,621.0,622.0,623.0,624.0,625.0,626.0,627.0,628.0,629.0,630.0,631.0,632.0,633.0,634.0,635.0,
			636.0,637.0,638.0,639.0,640.0,641.0,642.0,643.0,644.0,645.0,646.0,647.0,648.0,649.0,650.0,651.0,652.0,653.0,
			654.0,655.0,656.0,657.0,658.0,659.0,660.0,661.0,662.0,663.0,664.0,665.0,666.0,667.0,668.0,669.0,670.0,671.0,
			672.0,673.0,674.0,675.0,676.0,677.0,678.0,679.0,680.0,681.0,682.0,683.0,684.0,685.0,686.0,687.0,688.0,689.0,
			690.0,691.0,692.0,693.0,694.0,695.0,696.0,697.0,698.0,699.0};

		double DiI_Em [] = {2.843224,2.892825,2.926616,2.983924,3.121656,3.309256,3.48109,3.665323,3.954517,4.373206,
			4.946856,5.624003,6.555801,7.733393,9.166076,10.89194,12.85385,15.17715,17.79982,20.71966,23.91408,27.4473,
			31.34721,35.85917,40.58547,46.00974,51.54562,57.65722,63.4411,69.23384,74.56155,79.36227,83.78211,87.62179,
			91.43047,94.41985,96.86005,98.69796,99.83171,100,99.53056,98.31709,97.02834,95.09743,92.85651,90.35873,
			87.29849,84.34455,81.45704,78.53853,75.72188,72.43578,69.35341,66.09832,63.44553,60.86359,58.66696,56.4659,
			54.6147,53.09566,51.47033,49.907,48.38353,47.17892,46.06289,45.14614,44.32241,43.72453,43.16652,42.68822,
			42.34942,41.95084,41.45261,41.35518,41.25731,41.21745,40.9163,40.71568,40.45483,40.07307,39.72808,39.34057,
			38.91187,38.36581,37.76749,37.06599,36.2458,35.39105,34.67804,33.73029,32.82064,31.88087,30.89725,30,28.87865,
			27.94287,26.99513,26.16918,25.33171,24.52613,23.66076,22.86802,21.84012,20.97564,20.12312,19.48228,18.72055,
			17.99247,17.36625,17.00354,16.49513,16.0713,15.34765,14.82152,14.24048,13.85429,13.46457,13.11648,12.73738,
			12.29938,11.97874,11.62622,11.51506,11.17405,11.05226,10.72498,10.5403,10.25332,10.08503,9.910983,9.777679,
			9.64969,9.488485,9.238707,9.114703,8.984056,8.846324,8.591231,8.328167,8.146589,7.930469,7.841452,7.779008,
			7.618689,7.348095,7.084145,7.035872,6.820195,6.622675,6.357396,6.22365,5.986714,5.813995,5.633304,5.551816,
			5.40744,5.389725,5.300266,5.062445,4.857839,4.722764,4.692648,4.624003,4.446413,4.340567,4.232507,4.236935,
			4.161515,4.008547,3.734278};

		lambda = DiI_Lam;
		em = DiI_Em;
	}

	else if (dye == "mCherry" || dye == "MCHERRY" || dye == "mcherry") {

		elements = 251;

		double mCherry_Lam [] = {550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,
			579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,
			608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,
			637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,
			666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,
			695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,
			724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,
			753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,
			782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800};

		double mCherry_Em []	= {0.001,0.001,0.002,0.002,0.002,0.003,0.003,0.004,0.004,0.005,0.006,0.009,0.016,0.025,0.029,0.026,0.020,0.019,0.022,0.026,
			0.030,0.034,0.042,0.048,0.055,0.065,0.075,0.089,0.102,0.119,0.138,0.160,0.183,0.211,0.237,0.265,0.297,0.335,0.369,0.406,
			0.447,0.488,0.531,0.571,0.613,0.655,0.692,0.733,0.767,0.808,0.839,0.869,0.896,0.920,0.937,0.961,0.974,0.980,0.989,0.996,
			1.000,0.990,0.991,0.976,0.968,0.955,0.942,0.931,0.903,0.892,0.871,0.852,0.830,0.812,0.795,0.772,0.754,0.739,0.719,0.706,
			0.690,0.674,0.662,0.650,0.633,0.616,0.605,0.596,0.582,0.576,0.562,0.554,0.543,0.538,0.535,0.521,0.514,0.503,0.499,0.489,
			0.483,0.477,0.471,0.462,0.455,0.452,0.440,0.433,0.423,0.416,0.413,0.406,0.400,0.392,0.386,0.378,0.371,0.365,0.359,0.354,
			0.350,0.340,0.336,0.329,0.320,0.314,0.309,0.305,0.297,0.286,0.279,0.276,0.268,0.260,0.252,0.247,0.240,0.232,0.231,0.225,
			0.217,0.206,0.207,0.198,0.195,0.190,0.185,0.180,0.176,0.169,0.167,0.163,0.158,0.154,0.149,0.145,0.142,0.142,0.136,0.135,
			0.128,0.126,0.124,0.122,0.120,0.116,0.111,0.110,0.106,0.104,0.102,0.100,0.097,0.096,0.094,0.092,0.089,0.087,0.086,0.083,
			0.081,0.079,0.077,0.078,0.073,0.075,0.071,0.073,0.068,0.067,0.066,0.066,0.061,0.063,0.060,0.061,0.057,0.056,0.056,0.056,
			0.054,0.051,0.052,0.050,0.050,0.048,0.045,0.046,0.044,0.043,0.040,0.041,0.040,0.040,0.039,0.036,0.038,0.037,0.034,0.033,
			0.034,0.033,0.032,0.031,0.030,0.029,0.030,0.030,0.027,0.026,0.027,0.025,0.025,0.026,0.024,0.024,0.023,0.022,0.022,0.022,
			0.020,0.021,0.020,0.020,0.018,0.017,0.020,0.018,0.017,0.016,0.017};

		lambda = mCherry_Lam;
		em = mCherry_Em;
	}

	else if (dye == "Alexa488" || dye == "ALEXA488" || dye == "alexa488") {

		elements = 201;

		double Alexa488_Lam [] = {475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,
			499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,
			530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,
			561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,
			592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,
			623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,
			654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675};

		double Alexa488_Em [] = {0.979202,0.7017655,0.4852089,0.4840133,0.5698063,0.7110866,0.860956,1.069875,1.345994,1.668182,2.103955,
			2.581697,3.224486,3.944527,4.848526,5.912594,7.095542,8.524304,10.20722,12.18995,14.54477,17.12979,20.15777,23.53367,27.22775,31.25619,
			35.50921,40.04907,44.65386,49.65947,54.46586,59.60864,64.62728,69.77808,74.2916,79.11359,83.07986,86.77189,90.17967,92.87098,95.06226,
			96.95232,98.43452,99.46811,99.82077,100,99.61855,98.58117,97.27509,95.98027,94.28366,92.25999,90.39438,88.15095,85.96471,83.3491,80.76096,
			78.2592,75.45985,72.62863,70.0626,67.64776,65.06199,62.91389,60.53472,58.3782,56.18806,54.14721,52.26948,50.57441,48.9867,47.20159,45.73164,
			44.16367,42.74208,41.27572,40.0446,38.73765,37.65509,36.46091,35.37452,34.30606,33.2388,32.29171,31.38754,30.29636,29.28731,28.36565,27.50599,
			26.58718,25.79486,25.07528,24.25486,23.29783,22.4909,21.94921,21.06648,20.30616,19.48712,18.80446,18.15909,17.39656,16.72586,16.13629,
			15.49738,14.92194,14.26831,13.58558,12.9392,12.52339,11.93687,11.55976,11.1366,10.64905,10.29346,9.893942,9.468491,9.108702,8.730515,8.403642,
			8.075037,7.736989,7.423903,7.204468,6.877082,6.693296,6.419983,6.2086,6.008928,5.747986,5.592822,5.389613,5.110127,5.009059,4.797871,4.645317,
			4.523728,4.332036,4.204493,4.05372,3.892725,3.78197,3.636761,3.573026,3.407589,3.304398,3.133739,3.049361,2.89671,2.794667,2.688767,2.586186,
			2.439099,2.394738,2.279786,2.167665,2.108932,2.040317,1.971288,1.924316,1.859947,1.827836,1.693558,1.673745,1.584877,1.559769,1.494936,1.449404,
			1.420807,1.387061,1.312907,1.256346,1.215865,1.184193,1.170284,1.102231,1.063897,1.056992,1.010972,0.9797145,0.9391603,0.9019005,0.8845759,
			0.8243549,0.8167662,0.7988073,0.7606689,0.729558,0.7169916,0.7080365,0.6980078,0.6610407,0.6739731,0.6196326,0.6103847,0.6104335,0.6017713,
			0.555727,0.5344008,0.5249089,0.5088044};

		lambda = Alexa488_Lam;
		em = Alexa488_Em;
	}

	else if (dye == "Alexa568" || dye == "ALEXA568" || dye == "alexa568") {

		elements = 171;

		double Alexa568_Lam [] = {555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,
			579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,
			608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,
			637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,
			666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,
			695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,
			724,725};

		double Alexa568_Em [] = {3.538162,2.722276,2.00584,1.996602,2.110362,2.471931,2.885671,3.224416,3.713694,4.334122,4.997663,5.640554,6.544477,7.558719,
			8.514269,9.82849,10.90052,12.31672,14.12874,15.73279,18.62734,20.82339,23.72409,27.04578,30.01623,33.52052,37.09364,40.701,44.37339,48.52039,53.2322,
			56.55716,60.61285,65.04915,68.58694,72.44846,76.80015,79.79831,83.22598,87.19762,89.70035,92.39654,93.9716,95.75265,96.77595,98.2916,99.07742,99.34026,
			100,99.38699,98.55427,97.17103,95.91151,94.23862,93.49284,91.29372,88.66292,87.07444,84.44074,82.13348,80.02003,77.32185,75.34119,72.48921,70.00116,
			67.83555,65.09425,62.35639,60.16905,58.10723,56.17638,54.80203,52.59511,50.88418,48.75154,47.54763,45.55592,44.07867,43.24902,41.45204,40.31987,
			38.91037,37.83254,37.02535,35.6345,34.60903,33.30024,32.85154,32.33292,31.5558,30.78393,30.29302,29.23839,29.35686,28.28845,27.51079,27.46242,26.74562,
			26.15853,25.14628,24.47495,24.66678,23.66939,23.97353,23.22974,23.10729,22.40244,22.56602,22.19847,21.37262,21.16286,20.52413,20.20096,19.83505,19.26118,
			18.90739,18.13444,18.07049,17.87866,17.57868,16.54361,16.30033,15.44731,14.90115,14.57671,14.46857,14.057,13.69109,12.98479,12.17652,11.72075,11.51968,
			11.23274,10.79418,10.26415,10.30962,9.67524,9.407323,8.869317,8.99449,8.527131,8.671323,7.936772,7.976806,8.022999,7.684435,7.093534,6.91456,6.781054,
			6.498647,6.114977,6.114615,5.959553,5.902854,5.70631,5.091679,5.280071,5.100374,5.103997,5.015597,5.014328,4.753296,4.459476,4.523964,4.374518,4.613451,
			4.545158,4.231955,4.179966,4.170184,3.964945};

		lambda = Alexa568_Lam;
		em = Alexa568_Em;
	}

	else if (dye == "Alexa594" || dye == "ALEXA594" || dye == "alexa594") {

		elements = 171;

		double Alexa594_Lam [] = {580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,
			608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,
			637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,
			666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,
			695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,
			724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750};

		double Alexa594_Em [] = {6.159652,6.657252,7.393682,8.439029,9.697656,11.0455,12.52446,14.19956,16.21023,18.36772,20.67448,23.06124,25.72563,28.82137,31.39201,34.48686,37.65972,
			41.22657,44.79509,48.51176,52.36294,56.10341,59.79898,63.7296,67.78604,71.54912,74.81172,78.44492,81.79675,84.75771,87.60434,90.36494,92.63379,94.40963,
			95.86674,97.46132,98.5704,99.58007,100,99.82571,99.60434,99.47138,98.47868,97.6152,96.81441,95.33356,93.43191,91.77079,89.87393,88.16347,85.91565,84.12842,
			81.89742,79.76271,77.06181,74.86134,72.83564,70.24368,67.88036,65.78358,63.6376,61.58537,59.49122,57.66385,55.54511,53.62628,52.26034,50.51135,48.88625,
			47.27924,45.80135,44.53698,43.27085,42.0849,40.80254,39.76564,38.83087,37.70473,37.06108,36.12849,35.35397,34.63075,34.16343,33.4713,32.6449,32.10725,31.58802,
			30.96013,30.23204,29.76477,28.91156,28.51897,28.09375,27.64659,26.89773,26.57753,26.15461,25.553,25.07635,24.57134,24.15125,23.70088,23.18129,22.63349,
			22.18079,21.75091,21.26381,20.66264,20.10799,19.6894,19.32303,18.72565,18.39428,17.80299,17.46973,16.96676,16.58983,16.25421,15.8811,15.22661,14.91386,14.38712,
			13.97341,13.52077,13.00403,12.51318,12.24539,11.8706,11.48916,10.98058,10.65321,10.24641,10.03522,9.651175,9.36594,9.011077,8.51892,8.315224,8.065984,7.658446,
			7.36029,7.313755,7.034952,6.722994,6.35893,6.191506,6.046386,5.854695,5.79458,5.538778,5.463121,5.323188,5.202738,5.112418,4.845291,4.817102,4.67255,4.586245,
			4.398238,4.363708,4.170607,4.089836,4.061226,3.97734,3.864513,3.820215,3.751669,3.572405,3.574366,3.524642,3.403642};

		lambda = Alexa594_Lam;
		em = Alexa594_Em;
	}

	else if (dye == "Cy3" || dye == "CY3" || dye == "cy3") {

		elements = 301;

		double Cy3_Lam [] = {500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,
			530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,
			561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,
			592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,
			623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,
			654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,
			685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,
			716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,
			747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,
			778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800};

		double Cy3_Em [] = {0.62384028,0.677922989,0.714385752,0.715087905,0.779116334,0.830749519,0.859716969,0.90864374,0.921126675,0.941894136,1.028098748,
			1.025323571,1.048937496,1.053668357,1.052259634,1.079870092,1.095819002,1.079283387,1.114949367,1.136831566,1.136169158,1.127914283,1.174207822,1.206379438,
			1.196662848,1.255592622,1.296069582,1.362669419,1.436401821,1.55181235,1.631131066,1.805693435,1.962589047,2.186861722,2.483398775,2.831621375,3.250994875,
			3.84521211,4.467893994,5.16303898,6.113149508,7.317566323,8.707937045,10.37740896,12.25607587,14.63616096,17.51280657,20.61612845,24.63418004,28.82661546,
			33.51286713,38.29568538,44.07806582,50.08823915,56.24651447,62.17790532,68.40341828,73.83662098,79.57137738,84.67526831,88.716214,92.85431297,95.41222012,
			97.64781809,99.09943954,99.95577633,100,99.01395727,97.93107669,95.92038225,93.35212892,90.84500645,88.11058315,84.41194506,81.16601603,77.55582529,73.85592547,
			70.86751573,67.32072696,63.87380419,60.90545598,58.20496693,55.44928346,52.81034796,50.55261292,48.35221724,46.10596395,44.18215862,42.4655926,40.94441192,
			39.51181737,38.44641807,37.0490132,36.33636233,35.55309238,34.79813567,34.23961154,33.84409674,33.3362942,32.9388174,32.58599958,32.35927915,31.97956122,
			31.79130466,31.65294324,31.08161885,30.78885942,30.4919552,30.08989833,29.59643536,29.11568433,28.36991932,27.87892935,27.22320147,26.20772886,25.78195144,
			24.8791451,24.08043787,23.09657162,22.24681476,21.529874,20.66159493,19.71857722,18.96254173,18.07542501,17.38414786,16.54608094,15.79988064,15.01400521,
			14.33737045,13.6489322,12.96248117,12.44180897,11.77947593,11.33715722,10.81334331,10.2498795,9.724690308,9.272631037,8.892932036,8.527496902,8.156554314,
			7.806707866,7.524193691,7.201083322,6.960673108,6.604423376,6.331542517,6.145509752,5.931062176,5.658713766,5.437736101,5.262974379,5.155722833,4.897185331,
			4.717965282,4.562445588,4.468769005,4.204338588,4.107645837,3.978501997,3.802628059,3.726851022,3.53794088,3.478918999,3.300807382,3.220548676,3.051436355,
			3.004751048,2.871972161,2.771650041,2.61075285,2.573249159,2.438319652,2.342390879,2.220827519,2.140456519,2.080610728,1.939957379,1.866049596,1.810997121,
			1.721968124,1.692084026,1.532907205,1.487351147,1.423221149,1.359594581,1.310531542,1.282286433,1.240002675,1.152961535,1.108243898,1.054125103,1.058420035,
			1.000713509,0.926894047,0.926432254,0.850846369,0.830583601,0.820451902,0.788563545,0.772538931,0.731641184,0.713670981,0.667061378,0.640922729,0.603635299,
			0.548711773,0.537621978,0.534362674,0.484618301,0.504211469,0.431456025,0.45327987,0.417232721,0.393046916,0.40062216,0.366002344,0.356133148,0.321652186,
			0.293389224,0.302081604,0.29204548,0.294390849,0.274847709,0.254284334,0.250609984,0.259051595,0.234831723,0.210544033,0.214530724,0.201313399,0.205661891,
			0.198743001,0.181313512,0.180768003,0.18214657,0.163316939,0.157667665,0.148523018,0.142584555,0.145305288,0.135806347,0.14106133,0.119972696,0.133958227,
			0.117936136,0.111833459,0.101758538,0.110078076,0.099941708,0.102157623,0.096080307,0.094506676,0.08424792,0.095658384,0.088685049,0.073721867,0.072352447,
			0.077936363,0.063649721,0.061358133,0.060320713,0.053477457,0.060690306,0.064583465,0.050729489,0.05230833,0.059399832,0.049076022,0.045960758,0.048577159,
			0.049161662,0.045931492,0.046713979,0.038952366,0.046607401,0.038323961,0.035414428,0.041817101,0.029880918,0.036610196,0.037177483,0.026455527,0.027604269,
			0.029362081,0.032252947,0.026483045,0.028538152,0.019753142,0.027880399,0.028772058,0.024641246,0.02413256,0.018594634,0.024713871,0.020887363,0.014793732,
			0.016787601,0.021522278,0.01707474};

		lambda = Cy3_Lam;
		em = Cy3_Em;
	}

	else if (dye == "Cy5" || dye == "CY5" || dye == "cy5") {

		elements = 201;

		double Cy5_Lam [] = {600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,
			623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,
			654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,
			685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,
			716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,
			747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,
			778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800};

		double Cy5_Em [] = {1.021764854,1.050078393,1.093728433,1.106705472,1.08900951,1.152714973,1.078391933,1.110244664,1.13265955,1.143277127,1.160973089,1.251812361,
			1.182208244,1.240015053,1.163332551,1.349730019,1.40989629,1.462984176,1.506634216,1.638764067,1.724884416,1.868811575,2.06700635,2.208574048,2.35839986,2.668669063,
			2.906974687,3.237299313,3.506277938,4.039516263,4.648257361,5.062342875,5.891693633,6.64436189,7.530339727,8.644005611,9.972382502,11.13559708,13.11872457,14.73023685,
			16.63196292,18.53368898,21.33908885,23.95809124,26.88382365,29.78950063,33.13049828,36.96344368,40.65836058,44.94668207,49.43083887,53.47613582,57.41643672,62.38310342,
			66.68794115,71.29950888,75.61142499,79.81952478,83.81055411,86.64190805,90.38991283,92.75409337,94.64402213,96.47968327,98.46163103,98.86981788,100,98.82026919,
			98.55482976,97.29133806,95.32708627,93.80759298,91.78435465,88.98131424,85.7594694,83.19827382,79.46088661,75.89338065,72.46390319,68.78314306,65.07642886,61.68116359,
			58.1242752,55.43920788,52.56774309,48.9801817,46.53577947,44.10907319,41.22699083,38.74719666,35.96067249,34.14152759,32.2810921,30.43953231,28.70178883,27.19999151,
			25.42567637,24.01471832,22.54477373,21.52194712,20.50501916,19.55533586,18.76137703,18.0098885,16.96582674,16.12939759,15.69171746,15.32836037,14.42586631,13.99172537,
			13.52219251,12.99957176,12.71879583,12.34600089,11.80332472,11.37626216,11.14739439,10.77223999,10.57758441,10.39590586,9.883902691,9.958225732,9.6927863,9.390775213,
			9.132414166,9.043934355,9.013261354,8.81742604,8.621590725,8.29244583,8.036444244,7.712018272,7.780442659,7.420624762,7.204734024,7.064346058,6.875589128,6.618407812,
			6.330553494,6.186626336,6.019104561,5.797315169,5.575525777,5.311266075,5.122509146,4.898360292,4.828756174,4.518486972,4.48663424,4.115019035,4.054852764,3.859017449,
			3.625430749,3.490941437,3.358811586,3.196008735,3.080395115,2.906974687,2.588447368,2.646254178,2.545977059,2.371376899,2.325367398,2.176721316,1.998581964,1.875889959,
			1.903023768,1.860553459,1.748479032,1.641123528,1.571519411,1.527869371,1.529049102,1.432311175,1.341471903,1.258890746,1.265969131,1.145636589,1.164512282,1.018225661,
			1.073673009,1.13265955,1.009967546,0.927386389,0.921487735,0.880197157,0.864860656,0.779920038,0.786998423,0.746887575,0.801155192,0.709136189,0.723292959,0.639532072,
			0.653688841,0.60767934,0.632453687,0.558130646,0.574646877,0.552231992,0.553411723};

		lambda = Cy5_Lam;
		em = Cy5_Em;
	}

	else if (dye == "eGFP" || dye == "EGFP" || dye == "egfp") {

		elements = 238;

		double eGFP_Lam [] = {463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,
			489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,
			520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,
			551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,
			582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,
			613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,
			644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,
			675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700};

		double eGFP_Em [] = {0.003,0.003,0.003,0.004,0.004,0.005,0.006,0.007,0.009,0.010,0.012,0.015,0.018,0.022,0.027,0.032,0.038,0.046,0.055,0.065,0.078,0.092,0.109,0.127,
			0.148,0.172,0.198,0.227,0.259,0.295,0.331,0.371,0.416,0.460,0.509,0.559,0.610,0.665,0.718,0.767,0.816,0.862,0.903,0.935,0.966,0.988,0.999,1.000,1.000,0.989,0.970,
			0.941,0.906,0.871,0.834,0.793,0.751,0.715,0.680,0.650,0.621,0.597,0.570,0.547,0.528,0.508,0.490,0.473,0.464,0.450,0.439,0.430,0.422,0.410,0.401,0.394,0.387,0.381,
			0.369,0.362,0.358,0.348,0.339,0.330,0.322,0.312,0.302,0.291,0.280,0.267,0.256,0.245,0.234,0.224,0.216,0.207,0.196,0.186,0.181,0.171,0.162,0.155,0.149,0.141,0.135,
			0.128,0.122,0.117,0.114,0.108,0.104,0.097,0.096,0.092,0.088,0.084,0.081,0.079,0.076,0.074,0.071,0.069,0.065,0.064,0.063,0.059,0.059,0.056,0.054,0.053,0.050,0.049,
			0.047,0.046,0.044,0.042,0.041,0.039,0.037,0.036,0.036,0.034,0.032,0.032,0.030,0.029,0.028,0.027,0.026,0.025,0.024,0.022,0.022,0.022,0.021,0.020,0.019,0.018,0.018,
			0.017,0.017,0.016,0.015,0.015,0.015,0.015,0.014,0.013,0.014,0.013,0.013,0.012,0.012,0.012,0.011,0.011,0.011,0.011,0.010,0.010,0.010,0.010,0.010,0.010,0.009,0.010,
			0.009,0.009,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.008,0.007,0.008,0.008,0.007,0.007,0.007,0.007,0.007,0.007,0.007,0.006,0.007,0.007,0.006,0.007,0.006,
			0.007,0.007,0.007,0.007,0.006,0.007,0.006,0.007,0.007,0.007,0.007,0.006,0.007,0.006,0.007,0.006,0.007,0.007,0.006,0.006,0.006,0.007,0.007,0.006,0.006};

		lambda = eGFP_Lam;
		em = eGFP_Em;
	}

	else {
		cout << "\nThe dye - " << dye << " - is not in the library.  Please choose another\n";
		return 0;
	}

	spectra_spline = gsl_spline_alloc (gsl_interp_cspline, elements);
	gsl_spline_init (spectra_spline, lambda, em, elements);


	return 1;
}
*/

